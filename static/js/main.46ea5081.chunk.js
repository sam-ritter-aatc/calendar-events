(this["webpackJsonpcalendar-events"]=this["webpackJsonpcalendar-events"]||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},140:function(e,t,n){},170:function(e,t){},172:function(e,t){},189:function(e,t,n){},190:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(84),o=n.n(s),i=(n(103),n(32)),c=n(5),l=(n(104),n(4)),u=n.n(l),h=n(7),p=n(9),v=n(10),f=n(12),d=n(11),m=n(22),E=function(e){return"https://cors-anywhere.herokuapp.com/https://api.wildapricot.org/v2/accounts/"+e.Permissions[0].AccountId},b=function(e){return e.token_type+" "+e.access_token},g=n(35),k=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getEventById",n),e.next=3,g({url:E(t)+"/events/"+n,method:"GET",headers:{"Content-Type":"application/json",Authorization:b(t)}}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),a({})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),y=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.get(E(t)+"/events",{headers:{"Content-Type":"application/json",Authorization:b(t)},params:{$filter:"StartDate ge "+n}}).then((function(e){a(e.data.Events)})).catch((function(e){console.log("Error",e),a([])}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),w=n(85),I=n.n(w),D=function(e,t){var n=Object.assign({},e),a=e.Sessions.filter((function(e){return e.Id===Number(t)}));return console.log("foundSession",a),a&&(n.sessionId=a[0].Id,n.Name=a[0].Title,n.StartDate=a[0].StartDate,n.EndDate=a[0].EndDate),console.log("theEvent",n),n},O=function(e,t,n){return r.a.createElement(c.a,{to:{pathname:e,state:{member:t,eventInfo:n}},push:!0})},S=n(87),x=n(23),j=n(88),T=n(89),C=n(90),N=n(91),z=n(92),A=n.n(z),R=(n(140),n(35)),M=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.get(E(t)+"/contacts/"+n,{headers:{"Content-Type":"application/json",Authorization:b(t)}}).then((function(e){var t={};t.id=e.data.Id,t.firstName=e.data.FirstName,t.lastName=e.data.LastName,t.email=e.data.Email,t.displayName=e.data.DisplayName,t.isAdmin=W(e.data.FieldValues),a(t)})).catch((function(e){a(null)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),W=function(e){var t=e.filter((function(e){return"AdminRole"===e.SystemCode}));return t.length>0&&t[0].Value.length>0},F=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).calendarComponentRef=r.a.createRef(),e.state={events:[],member:null,calendarWeekends:!0,waToken:{},showEvent:!1,editEvent:!1},e.createEvent=function(){e.setState({editEvent:!0,eventInfo:{}})},e.handleEventClick=function(t){console.log("going to event",t),e.setState({showEvent:!0,eventInfo:t})},e.handleDateClick=function(t){console.log("DATE CLICKED",t),e.setState({editEvent:!0,eventInfo:t})},e}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.a.parse(this.props.location.search),console.log("QUERY_PARAMS",this.props.location.search,t),(n=new Date).setFullYear(n.getFullYear()-1),n.setMonth(n.getMonth()-6),console.log("FIRST DATE",n),e.next=8,Object(m.a)((function(e){return a.setState({waToken:e})}));case 8:if(!t.mid||"0"===t.mid){e.next=12;break}return e.next=11,M(this.state.waToken,t.mid,(function(e){a.setState({member:e})}));case 11:console.log("Retrieve Member",this.state.member);case 12:return e.next=14,y(this.state.waToken,n.toISOString(),(function(e){var t=I()(e).map((function(e){return{id:e.Id,title:e.Name.replace("Weekly Workout - ","").replace("Weekly Workout- ",""),start:e.StartDate,end:e.EndDate,Url:e.Url,Tags:e.Tags,backgroundColor:a.getEventColor(e),parentId:e.parentId}}));a.setState({events:t})}));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fixEventName",value:function(e){return e}},{key:"getEventColor",value:function(e){return/Race/.test(e.Name)?"red":"blue"}},{key:"buildRedirect",value:function(e){return r.a.createElement(c.a,{to:{pathname:e,state:{member:this.state.member,eventInfo:this.state.eventInfo}},push:!0})}},{key:"render",value:function(){return this.state.showEvent?O("showEvent",this.state.member,this.state.eventInfo):this.state.editEvent?O("editEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",{className:"EventCalendar"},r.a.createElement(S.a,{defaultView:"dayGridMonth",firstDay:1,fixedWeekCount:!1,header:{left:"prev today next",center:"title",right:"dayGridMonth,timeGridWeek,listMonth"},plugins:[x.d,j.a,N.a,T.a,C.a],themeSystem:"bootstrap",displayEventTime:!0,selectable:!0,ref:this.calendarComponentRef,weekends:this.state.calendarWeekends,events:this.state.events,dateClick:this.handleDateClick,eventClick:this.handleEventClick}),r.a.createElement("button",{onClick:this.createEvent},"Create Event"))}}]),n}(a.Component),B=(n(64),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{"data-testid":"switchable-text-input",className:this.props.className},r.a.createElement("label",null,this.props.label),this.props.inputFlag?r.a.createElement("input",{type:"text",className:"form-control",value:this.props.value,onChange:function(t){return e.props.onChange(t.target.value)}}):this.props.value)}}]),n}(a.Component)),P=n(93),L=n.n(P),_=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("h1",null,this.props.name),r.a.createElement("h2",null,"Loading"),r.a.createElement(L.a,{type:"ThreeDots",color:"#2BAD60",height:"100",width:"100"}))}}]),n}(a.Component),G=n(94),V=n.n(G),H=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{"data-testid":"switchable-text-input",className:this.props.className},r.a.createElement("label",null,this.props.label),r.a.createElement("br",null),this.props.displayFlag?r.a.createElement("div",null,V()(this.props.value)):r.a.createElement("div",null))}}]),n}(a.Component),U=(n(189),n(199)),Y=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"SwitchableButton"},this.props.isVisible&&r.a.createElement(U.a,{color:this.props.color,onClick:this.props.onClick,disabled:this.props.isDisabled},this.props.name))}}]),n}(a.Component),q=(n(190),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={fetch:!0,eventId:"",waToken:{},url:"",event:null,organizer:null},e}return Object(v.a)(n,[{key:"eventDetails",value:function(){var e=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("unmounting########")}},{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)((function(e){return t.setState({waToken:e})}));case 2:if(console.log("EVENT DETAILS",this.props.location.state),this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=10;break}return e.next=8,k(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){t.setState({event:D(e,t.state.eventInfo.event.id),fetch:!1})}));case 8:e.next=12;break;case 10:return e.next=12,k(this.state.waToken,this.state.eventInfo.event.id,(function(e){t.setState({event:e})}));case 12:if(console.log("state",this.state),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=17;break}return e.next=16,M(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){t.setState({organizer:e}),console.log("=====ORG",e,t.state.organizer)}));case 16:console.log("contact",this.state.organizer);case 17:console.log("state",this.state);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleEditClick",value:function(){this.setState({editEvent:!0})}},{key:"canEdit",value:function(){return this.member.isAdmin}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(_,{name:this.props.location.state.name}):this.state.editEvent?O("editEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",null,r.a.createElement(Y,{isVisible:this.canEdit,color:"warning",onClick:function(){return e.handleEditClick()},isDisabled:!1,name:"Edit"}),r.a.createElement("h2",null,this.state.event.Name),r.a.createElement(B,{className:"event_id",label:"Event Id: ",value:this.state.event.Id}),r.a.createElement(B,{className:"event-title",label:"Event Name: ",value:this.state.event.Name}),r.a.createElement(B,{className:"event-start",label:"Event Start Date/Time: ",value:this.state.event.StartDate}),r.a.createElement(B,{className:"event-end",label:"Event End Date/Time: ",value:this.state.event.EndDate}),r.a.createElement(B,{className:"location",label:"Event Location: ",value:this.state.event.Location}),this.state.organizer&&r.a.createElement(B,{className:"organizer",label:"Organizer: ",value:this.state.organizer.displayName+"("+this.state.organizer.email+")"}),r.a.createElement(H,{className:"descriptionHtml",label:"Description",value:this.state.event.Details.DescriptionHtml,displayFlag:this.state.event.Details&&this.state.event.Details.DescriptionHtml}))}}]),n}(a.Component)),J=n(48),K=n(96),$=n.n(K),Q=n(97),X=n.n(Q),Z=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).handleStartChange=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({date:Object(J.a)(Object(J.a)({},a.state.date),{},{date:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),console.log("INCOMING PROPS",e),a.state={isEditing:!0,eventInfo:e.location.state.eventInfo,member:e.location.state.member,fetch:!0},a}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)((function(e){return t.setState({waToken:e})}));case 2:if(console.log("EVENT DETAILS",this.props.location.state),this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),!this.state.eventInfo.event||!this.state.fetch){e.next=15;break}if(!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=11;break}return e.next=9,k(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){t.setState({event:D(e,t.state.eventInfo.event.id),fetch:!1})}));case 9:e.next=13;break;case 11:return e.next=13,k(this.state.waToken,this.state.eventInfo.event.id,(function(e){t.setState({event:e})}));case 13:e.next=16;break;case 15:this.state.eventInfo.date?this.setState({fetch:!1,event:{StartDate:new Date(this.state.eventInfo.date),Details:{DescriptionHtml:""}}}):this.setState({fetch:!1,event:{Details:{DescriptionHtml:""}}});case 16:if(console.log("===>state",this.state),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=21;break}return e.next=20,M(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){t.setState({organizer:e}),console.log("=====ORG",e,t.state.organizer)}));case 20:console.log("contact",this.state.organizer);case 21:console.log("state",this.state);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.fetch?r.a.createElement(_,{name:this.props.location.state.name}):r.a.createElement("div",{className:"App"},r.a.createElement("h2",null,"Description"),r.a.createElement($.a,{editor:X.a,data:this.state.event.Details.DescriptionHtml,onInit:function(e){console.log("Editor is ready to use!",e)},onChange:function(e,t){var n=t.getData();console.log({event:e,editor:t,data:n})},onBlur:function(e,t){console.log("Blur.",t)},onFocus:function(e,t){console.log("Focus.",t)}}))}}]),n}(a.Component);var ee=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,{basename:"/"},r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/",component:F}),r.a.createElement(c.b,{exact:!0,path:"/showEvent",component:q}),r.a.createElement(c.b,{exact:!0,path:"/editEvent",component:Z}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},22:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var a=n(4),r=n.n(a),s=n(7),o=n(35),i=n(124),c=function(){var t=Object(s.a)(r.a.mark((function t(n){var a,s,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("url","https://cors-anywhere.herokuapp.com/https://oauth.wildapricot.org/auth/token"),console.log("key","mf8q984b3zem9x5r6rk19yg37ht6uz"),a="Basic "+new e("APIKEY:mf8q984b3zem9x5r6rk19yg37ht6uz").toString("base64"),s={grant_type:"client_credentials",scope:"auto",obtain_refresh_token:!0},c={headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:a}},t.next=7,o.post("https://cors-anywhere.herokuapp.com/https://oauth.wildapricot.org/auth/token",i.stringify(s),c).then((function(e){n(e.data)})).catch((function(e){console.log("error",e)}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}).call(this,n(27).Buffer)},64:function(e,t,n){},85:function(e,t){var n=function(e){var t=Object.assign({},e);if(e.Sessions){var n=[];return e.Sessions.forEach((function(e){var a=Object.assign({},t);a.Id=e.Id,a.parentId=t.Id,a.Title=e.Title,a.StartDate=e.StartDate,a.EndDate=e.EndDate,a.StartTimeSpecified=e.StartTimeSpecified,a.EndTimeSpecified=e.EndTimeSpecified,a.isRecurringSession=!0,a.isOrganizedEvent=e.Details&&e.Details.Organizer,delete a.Sessions,n.push(a)})),n}return t};e.exports=function(e){var t=[];return Array.isArray(e)?e.forEach((function(e){var a=n(e);Array.isArray(a)?a.forEach((function(e){t.push(e)})):t.push(a)})):t.push(n(e)),t}},98:function(e,t,n){e.exports=n(197)}},[[98,1,2]]]);
//# sourceMappingURL=main.46ea5081.chunk.js.map